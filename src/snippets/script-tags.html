<% var templates = ['404', 'article', 'blog', 'cart', 'collection', 'gift_card', 'index', 'list-collections', 'page', 'password', 'product', 'search']; %>

<% if (!htmlWebpackPlugin.options.isDevServer) { %>
  <% for (var css in htmlWebpackPlugin.files.css) { %>
    <% var basename = htmlWebpackPlugin.files.css[css].split('/').reverse()[0]; %>
    <% var src = `{{ '${basename}' | asset_url }}` %>
    <link href="<%= src %>" rel="stylesheet">
  <% } %>
<% } %>

<% for (var chunk in htmlWebpackPlugin.files.chunks) { %>
  <% if (htmlWebpackPlugin.options.isDevServer === true) { %>
    <% var src = htmlWebpackPlugin.files.chunks[chunk].entry %>
  <% } else { %>
    <% var basename = htmlWebpackPlugin.files.chunks[chunk].entry.split('/').reverse()[0]; %>
    <% var src = `{{ '${basename}' | asset_url }}` %>
  <% } %>

  <% if (templates.indexOf(chunk) !== -1) { %>
    {% if template.name == '<%= chunk %>' %}
      <script src="<%= src %>" defer></script>
    {% endif %}
  <% } else { %>
    <script src="<%= src %>" defer></script>
  <% } %>
<% } %>
